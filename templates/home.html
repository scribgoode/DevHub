{% extends "base.html" %}

{% block content %}
        <div class="filtering-and-search">
        <form method="get">
            <div class="search-bar">
                <div class="search-bar-div">
                        <input type="text" name="search" placeholder="Search for people, projects, etc..." id="searchBox">
                        <button type="submit" id="searchButton">Search</button>
                </div>
                <div class="location-bar-div">
                        <i>&#128205;</i>
                        <select name="city">
                            <option value="any">Any</option>
                            {% for i in cities %}
                            <option value="{{ i.name }}">{{ i.name }}</option>
                            {% endfor %}
                        </select>
                        <button type="submit">Filter</button>
                </div>
                <div class="status-filter">
                    <button type="button" class="status-filter-button">Status &#8964;</button>
                    <div class="status-filter-content">
                        <div class="status-filter-form">
                            <input type="radio" name="status" value="any" {% if status == 'any' or not status %}checked{% endif %}>Any
                            <input type="radio" name="status" value="creator" {% if status == 'creator' %}checked{% endif %}>Creator
                            <input type="radio" name="status" value="recruit"{% if status == 'recruit' %}checked{% endif %}>Recruit
                            <button type="submit">status submit</button>
                        </div>
                    </div>
                </div>
                <div class="meeting-filter">
                    <button type="button" id="meeting-preferences-button">Meeting Preferences &#8964;</button>
                    <div class="meeting-filter-content">
                        <div class="meeting-filter-form">
                            <input type="radio" name="preference" value="any" {% if preference == 'any' or not preference %}checked{% endif %}>Any
                            <input type="radio" name="preference" value="in-person" {% if preference == 'in-person' %}checked{% endif %}>In-Person
                            <input type="radio" name="preference" value="video" {% if preference == 'video' %}checked{% endif %}>Video Chat
                            <input type="radio" name="preference" value="text" {% if preference == 'text' %}checked{% endif %}>Text Chat
                            <button type="submit">meet pref submit</button>
                        </div>
                    </div>
                </div>
                <div class="meeting-filter">
                    <button type="button" id="pitch-preferences-button">Has Elevator Pitch &#8964;</button>
                    <div class="pitch-filter-content">
                        <div class="meeting-filter-form">
                            <input type="radio" name="pitch" value="any" {% if pitch == 'any' or not pitch %}checked{% endif %}>Any
                            <input type="radio" name="pitch" value="true" {% if pitch == 'true' %}checked{% endif %}>True
                            <input type="radio" name="pitch" value="false" {% if pitch == 'false' %}checked{% endif %}>False
                        </div>
                    </div>
                </div>
            </div>
        </form>
        </div>
        <div class="engineer-table">
            <div class="table-head">
                <div class ="status">Status(add last online/off)</div>
                <div class="name">Name</div>
                <div class="location">Location</div>
                <div class="current-projects">Current Projects</div>
                <div class="meeting-preferences">Meeting Preference</div>
            </div>
            {% for profile in profiles %}
            <div class="table-row-box">
                {% if profile.id == user.id %} 
                    <a name="profile-button" href="my-profile/"> <!--remove this if we dont want to show the current user page in the rows of profiles-->
                {% else %}
                    <a name="profile-button" href="profile/{{profile.id}}">
                {% endif %}
                {% if profile.id != user.id %}
                    <div class="table-row">
                        <div class="row-background"></div>
                        <div class="status">{{ profile.status }} {% if profile.last_login_within_7_days %} Has logged in within the past 7 days {% elif profile.last_login_within_30_days %} Has logged in within the past 30 days {% else %} Has not logged in for at least a month{% endif %}</div>
                        <div class="name">{{ profile.first_name }}</div>
                        <div class="location">{{ profile.city }}</div>
                        <div class="current-projects" id="scrollBox">{{ profile.current_project }}</div>
                        <!--make that scrolly-->
                        <div class="meeting-preferences">{{ profile.meeting_preference }}</div>
                    </div>
                {% endif %}
                    </a>
            </div>
            {% endfor %}
        </div>
    </div>
        <script>
                document.addEventListener("DOMContentLoaded", function() {
                    document.querySelector(".status-filter").addEventListener("click", function() {
                        document.querySelector(".status-filter-content").classList.toggle("show");
                    });
                    document.querySelector("#meeting-preferences-button").addEventListener("click", function() {
                        document.querySelector(".meeting-filter-content").classList.toggle("show");
                    });
                    document.querySelector("#pitch-preferences-button").addEventListener("click", function() {
                        document.querySelector(".pitch-filter-content").classList.toggle("show");
                    });
                /*window.addEventListener("click", function(e) {
                    if (!e.target.matches('.status-filter')) {
                        let dropdowns = document.querySelectorAll(".status-filter-content");
                        dropdowns.forEach(function(filterbar) {
                            if (filterbar.classList.contains('show')) {
                                filterbar.classList.remove('show');
                            }
                        });
                    }
                });*/
            });
        </script>

        <script>
            const scrollBox = document.getElementById('scrollBox');

            // Limit scroll distance by modifying scroll step
            scrollBox.addEventListener('wheel', function(event) {
            event.preventDefault(); // Prevent default scrolling behavior

            const scrollAmount = 10; // Set custom scroll step (e.g., 30px)

            // Scroll by a limited amount based on wheel direction
            if (event.deltaY > 0) {
                scrollBox.scrollTop += scrollAmount;
            } else {
                scrollBox.scrollTop -= scrollAmount;
            }
            }, { passive: false });
        </script>
        <script> /***
            <div class="table-row-box">
                <a name="profile-button" href="#">
                    <div class="table-row">
                        <div class="row-background"></div>
                        <div class="status">creator/online</div>
                        <div class="name">Scrib Goode</div>
                        <div class="location">Chicago, IL</div>
                        <div class="current-projects">Website that provides seamless communication for the purpose of working with fellow engineers.</div>
                        <div class="meeting-preferences">in-person</div>
                    </div>
                </a>
            </div>
            ***/ </script>
{% endblock %}

